
32 bit program, with no security measure. We are interested in the **NX disabled** property, since this means its possible to add code to the stack and make it execute. 


Again there is a buffer we can overflow:
![[Pasted image 20250126202513.png]]

We find that the padding needed to overflow is 76.

![[Pasted image 20250126203250.png]]

- Our goal: Make the program jump to the ESP (Stack pointer) and populate the stack with our own shell code. 

Can use ropper to find what address we need to send in to make the program jump to esp. 

![[Pasted image 20250126203628.png]]

We make a payload on the form:
```
padding + jmp_esp + nop_slope + shellcode 
```

Dont worry to much about nop_slope, but just know we need some space between the commands. 

The shellcode we can generate with shellcode: 
![[Pasted image 20250127222317.png]]

- Note: there are lots of possible shellcodes that would work. Example we could also use msfvenom to generate. 


Then we send the payload to the program:
![[Pasted image 20250127223636.png]]


Notice we use the pwn lib to get an interactive shell. I tried to pip / send it with "<", but it did not work. Apparently its because need a way to handle input and output to the shell.  


Bonus code for more usability:
```python

# Allows you to switch between local/GDB/remote from terminal

def start(argv=[], *a, **kw):

    if args.GDB:  # Set GDBscript below

        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)

    elif args.REMOTE:  # ('server', 'port')

        return remote(sys.argv[1], sys.argv[2], *a, **kw)

    else:  # Run locally

        return process([exe] + argv, *a, **kw)

  
  

# Specify GDB script here (breakpoints etc)

gdbscript = '''

init-pwndbg

continue

'''.format(**locals())
```

- argv=[] : List of argument for the program 
- `*a`: A catch-all, for any additional positional arguments for process(), gdb.debug() or remote(). 
- `**kw`: Keyword arguments passed to the process(), gdb.debug() or remote(). 