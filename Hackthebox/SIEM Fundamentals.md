#SOC #hackthebox 


Definitions:
- SIEM: Security Information and Event Management

**How does SIEMs work:** 

"SIEM systems function by gathering data from a variety of sources, including PCs, network devices, servers, and more. This data is then standardized and consolidated to facilitate ease of analysis."

Step by step how does it work under the hood: 
```
1. SIEM solutions ingest logs from various data sources. Each SIEM tool possesses unique capabilities for collecting logs from different sources. This process is known as data ingestion or data collection.
    
2. The gathered data is processed and normalized to be understood by the SIEM correlation engine. The raw data must be written or read in a format that can be comprehended by the SIEM and converted into a common format from various types of datasets. This process is called data normalization and data aggregation.
    
3. Finally, the most crucial part of SIEM, where SOC teams utilize the normalized data collected by the SIEM to create various detection rules, dashboards, visualizations, alerts, and incidents. This enables the SOC team to identify potential security risks and respond swiftly to security incidents.
```


#### Elastic Stack - ELK

Open sourced framework which can work as a SIEM. 

It has different applications:
- Elasticsearch: Store search and analysis 
- Logstash:  Collecting, transforming and transporting log files records. 
- Kibana: Visualize 

"To implement the Elastic stack as a SIEM solution, security-related data from various sources such as firewalls, IDS/IPS, and endpoints should be ingested into the Elastic stack using Logstash. Elasticsearch should be configured to store and index the security data, and Kibana should be used to create custom dashboards and visualizations to provide insights into security-related events."


Example query in Elastic discover:
```
event.code:4625 AND winlog.event_data.SubStatus:0xC0000072 AND @timestamp >= "2023-03-03T00:00:00.000Z" AND @timestamp <= "2023-03-06T23:59:59.999Z"
```

event.code:4625 -> is a elastic common schema, and filters for unsuccessful login attempt 

winlog.event_data.SubStatus:0xC0000072 -> a windows event code that signifies that a user is disabled. 

@timestamp >= "2023-03-03T00:00:00.000Z" AND @timestamp <= "2023-03-06T23:59:59.999Z"

-> Filter between 2023 0303 - 2023 0306

Useful filter fields:
```
- event.code:
- username.keyword:
- group.name.keyword:
- host.name.keyword:
- @timestamp: 
```

#### Alert Triaging:

**Alert triaging:** "The process of evaluating and prioritizing security alerts generated by various monitoring and detection systems to determine their level of threat and potential impact on an organization's systems and data."

**(Short) Triaging process:**
```
- Initial alert review:
- Alert classification:
- Alert correlation:
- Risk Assessment: 
- Continuous monitoring:
```

#### Making SOP(standard operating procedure) in a SIEM:

Elements that should be considered when creating a SOP:
```
- process.name
- process.parent.name
- event.action
- machine where the alert was detected
- user associated with the machine
- user activity within +/- 2 days of the alert's generation
- After gathering this information, defenders should engage with the user and examine the user's machine to analyze system logs, antivirus logs, and proxy logs from the SIEM for full visibility.
```



